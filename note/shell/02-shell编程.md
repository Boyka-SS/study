
## 一、shell变量


 **每一个变量的值都是字符串** ，也可以使用 Shell declare 关键字显式定义变量的类型

### 1 定义变量

定义变量方式

```shell
var=value
var='value'
var="value"
```
> 如果 value 不包含任何空白符（例如空格、Tab 缩进等），那么可以不使用引号；如果 value 包含了空白符，那么就必须使用引号包围起来。

> **赋值号=的周围不能有空格**

命名规范：
- 变量名由数字、字母、下划线组成
- 必须以字母或者下划线开头
- 不能使用 Shell 里的关键字（通过 help 命令可以查看保留关键字）

### 2 使用变量

使用变量方式：
```shell
var='fan lihao'
var2=${var}
```
### 3 修改变量

```shell
url="http://c.biancheng.net"
echo ${url}
url="http://c.biancheng.net/shell/"
echo ${url}
```
对变量赋值时不能在变量名前加 \$，只有在使用变量时才能加 \\$。

### 4 单引号和双引号的区别

以单引号`' '`包围变量的值时， **单引号里面是什么就输出什么** ，即使 **内容中有变量和命令（命令需要反引起来）也会把它们原样输出** 。这种方式比较适合定义 **显示纯字符串** 的情况，即不希望解析变量、命令等的场景。

以双引号`" "`包围变量的值时，输出时会 **先解析里面的变量和命令** ，而不是把双引号中的变量名和命令原样输出。这种方式比较 **适合字符串中附带有变量和命令并且想将其解析后再输出** 的变量定义。

### 5 命令结果赋值变量

shell支持将命令结果赋值给变量，方式如下：

```shell
var=`command_line`
var=$(command_line)【推荐】
```

### 6 只读变量

使用 readonly 命令可以将变量定义为只读变量，只读变量的值不能被改变
```shell
myUrl="http://c.biancheng.net/shell/"
readonly myUrl
myUrl="http://c.biancheng.net/shell/"
```

### 7 删除变量

```shell
unset variable_name
```

## 二、shell变量作用域

Shell 变量的作用域可以分为三种：

- 变量_只能在函数内部使用_，这叫做 **局部变量** （local variable）
- 变量可以在 _当前 Shell 进程中_ 使用，这叫做 **全局变量** （global variable）
- 而有的变量还可以 _在子进程中_ 使用，这叫做 **环境变量** （environment variable）

### 1 局部变量

_在Shell函数中定义的变量默认是全局变量，_在函数外部也可以得到它的值。但是**要想变量的作用域仅限于函数内部，可以使用`local`命令**。

``shell
#!/bin/bash

#定义函数
function func(){
  local a=99
}

echo ${a}
``

### 2 全局变量

全局变量就是指变量在当前的Shell进程中都有效。每个Shell进程都有自己的作用域，彼此独立。

**在Shell中定义的变量，默认是全局变量**

需要强调的是，全局变量的作用范围是当前的 Shell 进程，而不是当前的 Shell 脚本文件，它们是不同的概念。

打开一个 Shell 窗口就创建了一个 Shell 进程，打开多个 Shell 窗口就创建了多个 Shell 进程，每个 Shell 进程都是独立的，拥有不同的进程 ID。

在一个 Shell 进程中可以使用 source 命令执行多个 Shell 脚本文件，此时全局变量在这些脚本文件中都有效。

> 需要在同一个进程中，多个shell脚本文件才可以共享全局变量。（运行方式：source filename.sh）
> 另外，全局变量只有当前Shell进程中有效，对其他Shell进程和子进程都无效，但是可以使用`export`命令可以将全局变为环境变量。

### 3 环境变量

父进程：创建环境变量的进程

子进程：父进程中创建的新进程

子进程创建时，会继承父进程的环境变量，同样环境变量也可以传给“孙进程”

> 两个没有父子关系的Shell进程是不能传递环境变量的，并且环境变量只能向下传递而不能向上传递，即“传子不传父”
> 脚本运行方式：bash filename.sh

**需要强调的是环境变量在 Shell 子进程中有效，并没有说它在所有的 Shell 进程中都有效。**
如果你通过终端创建了一个新的 Shell 窗口，那它就不是当前 Shell 的子进程，环境变量对这个新的 Shell 进程仍然是无效的。

**环境变量是临时的**
通过 export 导出的环境变量只对当前 Shell 进程以及所有的子进程有效，如果最顶层的父进程被关闭了，那么环境变量也就随之消失了，其它的进程也就无法使用了。

【拓展】

问：想让一个变量在所有 Shell 进程中都有效，不管它们之间是否存在父子关系，该怎么办呢?

答：只有将变量写入 Shell 配置文件中才能达到这个目的！Shell 进程每次启动时都会执行配置文件中的代码做一些初始化工作，如果将变量放在配置文件中，那么每次启动进程都会定义这个变量。

